%%%-------------------------------------------------------------------
%%% @author adoor balasubramanian <balu@localhost.localdomain>
%%% @copyright (C) 2015, adoor balasubramanian
%%% @doc
%%%
%%% @end
%%% Created : 30 Jan 2015 by adoor balasubramanian <balu@localhost.localdomain>
%%%-------------------------------------------------------------------
-module(sniffer_tests).

-include_lib("eunit/include/eunit.hrl").

process_session_test() ->
Msg = #msg{sender = sniffer,
     session_key = {443,58219,<<10,0,0,7>>,<<207,192,66,11>>},
     ts = #timeStamp{seconds = 1422604956,micro = 938179},
     len = 140,
     five_tuple = #five_tuple{sip = <<207,192,66,11>>,
                              dip = <<10,0,0,7>>,
                              proto = 6,sp = 443,dp = 58219},
     pdu = <<41,148,172,159,121,51,167,213,128,24,2,149,27,253,0,0,1,1,8,10,21,175,100,193,3,36,70,25,23,3,1,0,32,98,179,79,4,136,92,148,16,76,14,254,126,210,19,253,46,162,248,30,247,183,232,11,198,177,244,99,201,66,119,197,65,23,3,1,0,32,207,38,67,122,174,215,249,254,153,161,94,46,25,158,115,50,152,191,101,222,251,219,163,79,137,64,220,254,90,198,183,71>>,
     pcap_record = <<84,203,58,156,0,14,80,195,0,0,0,140,0,0,0,140,248,15,65,181,238,126,132,27,94,239,126,228,8,0,69,32,0,126,23,213,0,0,48,6,86,179,207,192,66,11,10,0,0,7,1,187,227,107,41,148,172,159,121,51,167,213,128,24,2,149,27,253,0,0,1,1,8,10,21,175,100,193,3,36,70,25,23,3,1,0,32,98,179,79,4,136,92,148,16,76,14,254,126,210,19,253,46,162,248,30,247,183,232,11,198,177,244,99,201,66,119,197,65,23,3,1,0,32,207,38,67,122,174,215,249,254,153,161,94,46,25,158,115,50,152,191,101,222,251,219,163,79,137,64,220,254,90,198,183,71>>},


process_session(Msg, p2p1,
             {443,58219,<<10,0,0,7>>,<<207,192,66,11>>},
             [],[]).

