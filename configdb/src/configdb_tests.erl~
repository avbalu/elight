%%%-------------------------------------------------------------------
%%% @author adoor balasubramanian <balu@localhost.localdomain>
%%% @copyright (C) 2015, adoor balasubramanian
%%% @doc
%%%
%%% @end
%%% Created : 29 Jan 2015 by adoor balasubramanian <balu@localhost.localdomain>
%%%-------------------------------------------------------------------
-module(configdb_tests).

-include("../../common/common.hrl").

-include_lib("eunit/include/eunit.hrl").


%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% TESTS DESCRIPTIONS %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%
 
unit_test_() ->
    {setup,
     fun setup/0,
     fun cleanup/1,
     fun test/1
    }.

%%%%%%%%%%%%%%%%%%%%%%%
%%% SETUP FUNCTIONS %%%
%%%%%%%%%%%%%%%%%%%%%%%
 

setup() ->
    test:setup().

cleanup(X) ->
    test:cleanup(X).

%%%%%%%%%%%%%%%%%%%%
%%% ACTUAL TESTS %%%
%%%%%%%%%%%%%%%%%%%%


test(_) ->
    [?_test(first_time_init()),
     ?_test(init_tables()),
     ?_test(get_test())].


init_test() ->
    first_time_init(),
    init_tables(),
    [ [#config{} = X || X <- mread(Table)] 
      || Table <- [default,startup,running] 
    ].
    

get_test() ->
    [get(Table,Key) || Table <- tables(), 
		       Key <- keys()].

